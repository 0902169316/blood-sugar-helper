
<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>血糖助手</title>
    <style>
        body { font-family: Arial, sans-serif; background-color: #f0f8f5; padding: 20px; }
        .container { max-width: 500px; margin: auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
        h1 { text-align: center; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; }
        input[type="number"] { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; }
        .result { margin-top: 20px; font-weight: bold; color: green; }
    </style>
</head>
<body>
    <div class="container">
        <h1>血糖助手</h1>
        <div class="form-group">
            <label for="correctionFactor">血糖修正因子（每 1U 可降幾 mg/dL）</label>
            <input type="number" id="correctionFactor" value="100">
        </div>
        <div class="form-group">
            <label for="target">目標血糖（mg/dL）</label>
            <input type="number" id="target" value="100">
        </div>
        <div class="form-group">
            <label for="preMeal">餐前血糖</label>
            <input type="number" id="preMeal">
        </div>
        <div class="form-group">
            <label for="carbs">碳水化合物（g）</label>
            <input type="number" id="carbs">
        </div>
        <div class="form-group">
            <label for="ci">碳水比（CI 值）</label>
            <input type="number" id="ci" value="10">
        </div>
        <div class="form-group">
            <label for="actualInsulin">實際打的胰島素劑量</label>
            <input type="number" id="actualInsulin">
        </div>
        <div class="result" id="suggestion"></div>
        <div class="result" id="estimate"></div>
    </div>

    <script>
        const inputs = document.querySelectorAll('input');
        inputs.forEach(input => input.addEventListener('input', update));

        function update() {
            const cf = parseFloat(document.getElementById("correctionFactor").value);
            const target = parseFloat(document.getElementById("target").value);
            const pre = parseFloat(document.getElementById("preMeal").value);
            const carbs = parseFloat(document.getElementById("carbs").value);
            const ci = parseFloat(document.getElementById("ci").value);
            const actual = parseFloat(document.getElementById("actualInsulin").value);

            if (isNaN(cf) || isNaN(target) || isNaN(pre) || isNaN(carbs) || isNaN(ci)) return;

            const carbInsulin = carbs / ci;
            const correctionInsulin = (pre - target) / cf;
            const totalSuggested = carbInsulin + correctionInsulin;
            document.getElementById("suggestion").textContent = `建議胰島素：${totalSuggested.toFixed(1)} 單位`;

            if (!isNaN(actual)) {
                const estimatedBG = pre - (actual - carbInsulin) * cf;
                document.getElementById("estimate").textContent = `預估血糖：${estimatedBG.toFixed(0)} mg/dL`;
            } else {
                document.getElementById("estimate").textContent = "";
            }
        }
    </script>
</body>
</html>
